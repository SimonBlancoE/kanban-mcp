<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agent Kanban Board + Ralph Wiggum</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <!-- Header con estadísticas -->
  <header>
    <div class="header-left">
      <h1>AI Agent Kanban</h1>
      <div id="connection-status" class="status disconnected">
        <span class="status-dot"></span>
        <span class="status-text">Disconnected</span>
      </div>
      <button id="toggle-activity" class="toggle-btn" title="Toggle Activity Feed">Activity</button>
    </div>

    <div class="sprint-info" id="sprint-info" style="display: none;">
      <span class="sprint-label">Sprint:</span>
      <span class="sprint-goal" id="sprint-goal">--</span>
      <span class="sprint-iter" id="sprint-iter">Iter 1/5</span>
    </div>

    <div class="stats" id="stats">
      <div class="stat stat-backlog">
        <span class="stat-label">Backlog</span>
        <span class="stat-value" id="stat-backlog">0</span>
      </div>
      <div class="stat stat-in-progress">
        <span class="stat-label">In Progress</span>
        <span class="stat-value" id="stat-in_progress">0</span>
      </div>
      <div class="stat stat-blocked">
        <span class="stat-label">Blocked</span>
        <span class="stat-value" id="stat-blocked">0</span>
      </div>
      <div class="stat stat-done">
        <span class="stat-label">Done</span>
        <span class="stat-value" id="stat-done">0</span>
      </div>
    </div>
  </header>

  <!-- Main container with board and activity sidebar -->
  <div class="main-container">
    <!-- Tablero Kanban -->
    <main class="board">
      <div class="column column-backlog" data-column="backlog">
        <div class="column-header">
          <h2>Backlog</h2>
          <span class="column-count" id="count-backlog">0</span>
        </div>
        <div class="task-list" id="col-backlog"></div>
      </div>

      <div class="column column-in-progress" data-column="in_progress">
        <div class="column-header">
          <h2>In Progress</h2>
          <span class="column-count" id="count-in_progress">0</span>
        </div>
        <div class="task-list" id="col-in_progress"></div>
      </div>

      <div class="column column-blocked" data-column="blocked">
        <div class="column-header">
          <h2>Blocked</h2>
          <span class="column-count" id="count-blocked">0</span>
        </div>
        <div class="task-list" id="col-blocked"></div>
      </div>

      <div class="column column-done" data-column="done">
        <div class="column-header">
          <h2>Done</h2>
          <span class="column-count" id="count-done">0</span>
        </div>
        <div class="task-list" id="col-done"></div>
      </div>
    </main>

    <!-- Activity Sidebar -->
    <aside class="activity-sidebar" id="activity-sidebar">
      <div class="sidebar-header">
        <h3>Live Activity</h3>
        <button class="close-sidebar" id="close-sidebar">&times;</button>
      </div>
      <div class="activity-feed" id="activity-feed">
        <div class="activity-empty">No activity yet</div>
      </div>
    </aside>
  </div>

  <!-- Task Detail Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="task-modal">
      <div class="modal-header">
        <h2 id="modal-title">Task Detail</h2>
        <button class="modal-close" id="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Task Info Section -->
        <div class="modal-section">
          <div class="task-meta">
            <span class="meta-item" id="modal-assignee">Unassigned</span>
            <span class="meta-item" id="modal-priority">Medium</span>
            <span class="meta-item" id="modal-column">Backlog</span>
          </div>
          <p class="task-description" id="modal-description">No description</p>
        </div>

        <!-- Acceptance Criteria Section -->
        <div class="modal-section" id="criteria-section" style="display: none;">
          <h3>Acceptance Criteria</h3>
          <p id="modal-criteria-desc"></p>
          <div id="modal-criteria-steps" class="criteria-steps"></div>
          <code id="modal-criteria-cmd" class="criteria-cmd"></code>
        </div>

        <!-- Iteration Progress Section -->
        <div class="modal-section">
          <h3>Iteration Progress</h3>
          <div class="iteration-progress">
            <div class="progress-bar">
              <div class="progress-fill" id="modal-progress"></div>
            </div>
            <span class="progress-text" id="modal-iter-text">Iteration 1 of 3</span>
          </div>
        </div>

        <!-- Iteration Timeline Section -->
        <div class="modal-section" id="timeline-section">
          <h3>Iteration Timeline</h3>
          <div class="iteration-timeline" id="modal-timeline">
            <div class="timeline-empty">No iterations yet</div>
          </div>
        </div>

        <!-- Learning Insights Section -->
        <div class="modal-section" id="learning-section" style="display: none;">
          <h3>Learning Insights</h3>
          <div id="modal-learning"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <span>Claude Kanban MCP + Ralph Wiggum</span>
    <span class="separator">•</span>
    <span id="last-update">Last update: --</span>
    <span class="separator">•</span>
    <span id="escalated-count" style="display: none;" class="escalated-warning">0 escalated</span>
  </footer>

  <script src="/app.js"></script>
</body>
</html>
